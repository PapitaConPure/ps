CodeMirror.defineSimpleMode("pureescript",{start:[{token:"comment",regex:/\/\/.*/},{token:"operator",regex:/[-+*/^%=<>!():,.]+/i},{token:["stmt-control",null,"operator",null,"symbol",null,"keyword"],regex:/\b(PARAR)(\s+)(con)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(si)\b/i},{token:["stmt-control",null,"operator",null,"number",null,"keyword"],regex:/\b(PARAR)(\s+)(con)(\s+)((?!_)(?:(?:[0-9_]+(?:[.][0-9]*)?)|(?:[.][0-9]+)))(\s+)(si)\b/i},{token:["stmt-control",null,"operator",null,"string",null,"keyword"],regex:/\b(PARAR)(\s+)(con)(\s+)((?:"|').*?(?:"|'))(\s+)(si)\b/i},{token:["stmt-control",null,"symbol",null,null,null,"symbol",null,"stmt-control"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(con)(\s+)([a-zÀ-ÖØ-öø-ÿ_][a-zÀ-ÖØ-öø-ÿ_0-9]*)(\s+)(MIENTRAS)\b/i,indent:!0},{token:["stmt-control",null,"symbol",null,null,null,"number",null,"stmt-control"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(con)(\s+)((?!_)(?:(?:[0-9_]+(?:[.][0-9]*)?)|(?:[.][0-9]+)))(\s+)(MIENTRAS)\b/i,indent:!0},{token:["stmt-control",null,"symbol",null,null,null,"string",null,"stmt-control"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(con)(\s+)((?:"|').*?(?:"|'))(\s+)(MIENTRAS)\b/i,indent:!0},{token:"stmt-control",regex:/\bPARA\s+CADA\b/i,indent:!0},{token:["stmt-control",null,"symbol",null,"keyword",null,"symbol",null,"keyword"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(desde)(\s+)([a-zÀ-ÖØ-öø-ÿ_][a-zÀ-ÖØ-öø-ÿ_0-9]*)(\s+)(hasta)\b/i,indent:!0},{token:["stmt-control",null,"symbol",null,"keyword",null,"number",null,"keyword"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(desde)(\s+)((?!_)(?:(?:[0-9_]+(?:[.][0-9]*)?)|(?:[.][0-9]+)))(\s+)(hasta)\b/i,indent:!0},{token:["stmt-control",null,"symbol",null,"keyword",null,"string",null,"keyword"],regex:/\b(PARA)(\s+)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+)(desde)(\s+)((?:"|').*?(?:"|'))(\s+)(hasta)\b/i,indent:!0},{token:"stmt-general",regex:/\b(BORRAR|CARGAR|COMENTAR|CREAR|DEVOLVER|DIVIDIR|EJECUTAR|USAR|ENVIAR|DECIR|EXTENDER|GUARDAR|LEER|MULTIPLICAR|PARAR|RESTAR|SUMAR|TERMINAR)\b/i},{token:"stmt-control",regex:/\b(BLOQUE|HACER|MIENTRAS|PARA|SI|REPETIR)\b/i,indent:!0},{token:"stmt-control",regex:/\b(SINO)\b/i,indent:!0,dedent:!0},{token:"stmt-control2",regex:/\b(FIN|HASTA)\b/i,dedent:!0},{token:"keyword",regex:/\b(con|en|desde|opcional|veces)\b/i},{token:"type",regex:/\b(Número|Numero|Texto|Lógico|Logico|Lista|Registro|Marco)\b/i},{token:["function","operator","type"],regex:/\b([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s+con\s+)(Función|Funcion)/i,indent:!0},{token:"type",regex:/\b(Función|Funcion)\b/,indent:!0},{token:"atom",regex:/\b(Verdadero|Falso|Nada)\b/i},{token:"operator",regex:/\b(es|no|precede|excede|y|o)\b/i},{token:[null,"function",null,"operator"],regex:/(\b)([a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*)(\s*)(\()/i},{token:"symbol",regex:/\b[a-zÀ-ÖØ-öø-ÿ_][0-9a-zÀ-ÖØ-öø-ÿ_]*\b/i},{token:"number",regex:/^(?!_)(([0-9_]+([.][0-9]*)?)|([.][0-9]+))/},{token:"string",regex:/\'/,next:"stringSQ"},{token:"string",regex:/\"/,next:"stringDQ"}],stringSQ:[{token:"string",regex:/\'/,next:"start"},{token:"string2",regex:/\\[nt\\'\"]/ig},{token:"error",regex:/\\[^nt\\'\"]/ig},{token:"string",regex:/[^'\\]+/}],stringDQ:[{token:"string",regex:/\"/,next:"start"},{token:"string2",regex:/\\[nt\\'\"]/ig},{token:"error",regex:/\\[^nt\\'\"]/ig},{token:"string",regex:/[^"\\]+/}],meta:{dontIndentStates:["comment"],lineComment:"//",electricInput:/\b(SINO|HASTA|FIN)\b/i}});const scopeTokens=["BLOQUE","HACER","MIENTRAS","PARA","PARA CADA","REPETIR","SI"],unscopeTokens=["FIN","HASTA"],statementTokens=[...scopeTokens,...unscopeTokens,"SINO","BORRAR","CARGAR","COMENTAR","CREAR","DEVOLVER","DIVIDIR","EJECUTAR","ENVIAR","EXTENDER","GUARDAR","LEER","MULTIPLICAR","PARAR","RESTAR","SUMAR","TERMINAR"],typeTokens=["N\xFAmero","Texto","L\xF3gico","Lista","Registro","Marco","Funci\xF3n"],keywords=["Verdadero","Falso","Nada","con","en","desde","opcional","veces"],tokens=new Map([...statementTokens,...typeTokens,...keywords].map(r=>[r,{bias:e=>e===0?-4:2,value:r}])),nativeVariableNames=(()=>{const r=i=>{const t=i.toString();let o=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/\[(.*?)\]/);return o==null||o[1]==null?"":(o=o[1],o.split(/\s*?,\s*?/g).join(", "))},e=new Pur\u00E9Script.Scope;Pur\u00E9Script.declareNatives(e);const a=new Map;for(const[i,t]of e.variables){let o;t.kind==="NativeFunction"||t.kind==="Function"?(o=`${i}()`,a.set(o,{bias:l=>0,value:o}),o=`${i}(${r(t.call)})`):o=i,a.set(o,{bias:l=>0,value:o})}return a})();function getDeclaredVariables(r){const e=r.getCursor(),a=r.getTokenAt(e),i=r.getValue().split(`
`).slice(0,e.line+1);i[i.length-1]=i[i.length-1].slice(0,a.start);const t=i.join(`
`),o=new Map,l=t.matchAll(/\b(?:(?:CREAR\s+?[a-zÀ-ÖØ-öø-ÿ_]+?\s+?)|(?:CARGAR\s+?)|(?:LEER\s+?[a-zÀ-ÖØ-öø-ÿ_]+?\s+?(?:opcional\s+?)?)|(?:PARA\s+?CADA\s+?))([a-zÀ-ÖØ-öø-ÿ_]+)/gi);for(const A of l)o.set(A[1],{bias:d=>-1,value:A[1]});return o}CodeMirror.registerHelper("hint","pureescript",function(r){const e=r.getCursor(),a=r.getTokenAt(e),i=a.start,t=a.end,o=a.string.trim();return o.length?{list:Array.from(new Map([...tokens.entries(),...nativeVariableNames.entries(),...getDeclaredVariables(r).entries()]).values()).map(d=>{const c=d.value.toLowerCase().indexOf(o.toLowerCase()),g=(d.value.length-o.length)*.25;return{distance:c>=0?c+g+d.bias(i):9999,hint:d.value}}).filter(d=>d.distance<8).sort((d,c)=>d.distance-c.distance).map(d=>d.hint),from:CodeMirror.Pos(e.line,i),to:CodeMirror.Pos(e.line,t)}:{list:(i===0?Array.from(tokens.values()):new Map([...nativeVariableNames.entries(),...getDeclaredVariables(r).entries()])).map(d=>d.value),from:CodeMirror.Pos(e.line,e.ch),to:CodeMirror.Pos(e.line,e.ch)}});const editor=CodeMirror.fromTextArea(document.getElementById("editor"),{lineNumbers:!0,mode:"pureescript",theme:"psdocs",indentWithTabs:!0,electricChars:!0,scrollbarStyle:"overlay",tabSize:2,styleActiveLine:{nonEmpty:!0},extraKeys:{"Ctrl-Space":"autocomplete"},hintOptions:{hint:CodeMirror.hint.pureescript},screenReaderLabel:"Editor de c\xF3digo Pur\xE9Script"});editor.on("inputRead",function(r,e){e.text[0]&&/\w/.test(e.text[0])&&r.showHint({completeSingle:!1})});function gotoPSDocs(){window.open("https://papitaconpure.github.io/ps-docs/","_blank")}async function exportPS(){const r=editor.getDoc().getValue().trim(),e="script.tuber";if(window.showSaveFilePicker){const a=await window.showSaveFilePicker({suggestedName:"script.tuber",types:[{id:"psexport",description:"Archivo Pur\xE9Script",accept:{"text/plain":[".tuber"]}}]});let i;try{i=await a.createWritable(),await i.write(r)}finally{await i?.close()}}else{let a=prompt("Ingresa el nombre del archivo");if(a==null)return;a||(a=e),a.endsWith(".tuber")||(a+=".tuber");const i=new Blob([r],{type:"text/plain"}),t=URL.createObjectURL(i),o=document.createElement("a");o.href=t,o.download=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t)}}const{lexer,parser,interpreter,Scope,EnvironmentProvider,declareNatives,declareContext,PSGuild,PSUser,stringifyPSAST,coerceValue}=Pur\u00E9Script;class BrowserEnvironmentProvider{constructor(){this.guild=new PSGuild({id:"123456789012345678",name:"Servidor de Prueba",ownerId:"123456789012345684",description:"Este ser un servidor que realmente no existe",systemChannelId:"123456789012345680",iconUrlHandler:this.#e,bannerUrlHandler:this.#e,splashUrlHandler:this.#e,premiumTier:0,channels:[{id:"123456789012345680",name:"canal-de-prueba-2",nsfw:!1}],roles:[{id:"123456789012345681",name:"Rol de Prueba 1",iconUrlHandler:e=>"https://i.imgur.com/ALNMRS6.png",color:6327539},{id:"123456789012345682",name:"Rol de Prueba 2",iconUrlHandler:e=>null}],members:[{user:new PSUser({id:"123456789012345683",username:"usuario.de.prueba",displayName:"Usuario de Prueba"}),displayAvatarUrlHandler:e=>"https://i.imgur.com/P9eeVWC.png",roleIds:["123456789012345682"]},{user:new PSUser({id:"123456789012345684",username:"otro.usuario",displayName:"Otro Usuario"}),nickname:"Otro Usuario",displayAvatarUrlHandler:e=>"https://i.imgur.com/P9eeVWC.png",roleIds:[]}]}),this.channel=this.guild.registerChannel({id:"123456789012345679",name:"canal-de-prueba-1",nsfw:!1}),this.user=new PSUser({id:"651250669390528561",username:"botdepure"}),this.member=this.guild.registerMember({user:this.user,nickname:"Bot de Pur\xE9",displayAvatarUrlHandler:e=>"https://i.imgur.com/P9eeVWC.png",roleIds:["123456789012345681","123456789012345682"]})}getGuild(){return this.guild}getChannel(){return this.channel}getUser(){return this.user}getMember(){return this.member}fetchChannel(e){if(!isNaN(+e)){const t=this.guild.channels.get(e);if(t)return t}let a=0,i=null;for(const t of this.guild.channels.values())t.name.includes(e)&&t.name.length>a&&(a=t.name.length,i=t);return i}fetchRole(e){if(!isNaN(+e)){const t=this.guild.roles.get(e);if(t)return t}let a=0,i=null;for(const t of this.guild.roles.values())t.name.includes(e)&&t.name.length>a&&(a=t.name.length,i=t);return i}fetchMember(e){if(!isNaN(+e)){const t=this.guild.members.get(e);if(t)return t}let a=0,i=null;for(const t of this.guild.members.values()){const o=l=>l&&l.includes(e)&&l.length>a?(a=l.length,i=t,!0):!1;o(t.nickname)||o(t.user.displayName)||o(t.user.username)}return i}#e(e){return""}}function sanitizeHtml(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function markup(r){const e="<<<PART/CODE/BLOCK>>>",a="<<<PART/CODE/INLINE>>>",i=[];return sanitizeHtml(r).replace(/```([a-z0-9]{0,4})?\n((?:.|\n)+?)```/gi,(t,o,l)=>(l=l.replace(/\n/g,"<br>"),i.push({lang:o,code:l}),e)).replace(/\`([^`]+)\`/g,(t,o)=>(o=o.replace(/\n/g,"<br>"),i.push({code:o}),a)).replace(/^([\t ]*?)([-*]|(?:[0-9]+\.)) (.+)$/gm,(t,o,l,A)=>{const d=l==="*"||l==="-"?"ul":"ol",c=d==="ul"?"\u2022":l,f=o.replace(/  /g,"	").length;return(f?`<span class="list-indent" style="width:${.5*f}rem"></span>`:"")+`<span class="list-order" style="width:${d==="ul"?.5:1}rem">${c}</span><${d}">${A}</${d}>`}).replace(/^( +?)\* (.+)/gm,"<li>$1</li>").replace(/^### (.+)/gm,"<h3>$1</h3>").replace(/^## (.+)/gm,"<h2>$1</h2>").replace(/^# (.+)/gm,"<h1>$1</h1>").replace(/^-# (.+)/gm,'<div class="disclaimer">$1</div>').replace(/^&gt; (.+)/gm,'<div class="quote">$1</div>').replace(/\n ?<([a-z0-9])/gi,"<$1").replace(/([a-z0-9])> ?\n/gi,"$1>").replace(/\*\*([^*]+)\*\*/g,"<b>$1</b>").replace(/\*([^*]+)\*/g,"<i>$1</i>").replace(/__([^_]+)__/g,'<span class="underline">$1</span>').replace(/_([^_]+)_/g,"<i>$1</i>").replace(/~~([^~]+)~~/g,'<span class="line-through">$1</span>').replace(/\|\|([^\|]+)\|\|/g,'<span class="spoiler">$1</span>').replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2">$1</a>').replaceAll(e,()=>`<code class="block w-full">${i.shift().code}</code>`).replaceAll(a,()=>`<code>${i.shift().code}</code>`).replace(/\n/g,"<br>")}function groupQuoted(r){const e=[];let a=!1,i=[];for(let t of r)t.startsWith('"')&&!a?(a=!0,i.push(t.slice(1))):t.endsWith('"')&&a&&!t.endsWith('\\"')?(i.push(t.slice(0,-1)),e.push(i.join(" ").trim()),i=[],a=!1):a?i.push(t):e.push(t);return a&&e.push(i.join(" ")),e}function createSendButton(r){const e=document.createElement("button"),a=document.createElement("i");return a.classList.add("fa","fa-paper-plane"),e.ariaLabel="Volver a ejecutar orden",e.appendChild(a),e}let savedData=new Map,messagesToAppend=[],busyOutput=!1,lastInput=null;setInterval(function(){if(!busyOutput)return;const r=messagesToAppend.shift();if(!r){busyOutput=!1;return}r()},80);const MessageKinds={text:{className:"message-text",icon:"fa-comment"},embed:{className:"message-embed",icon:null},error:{className:"message-error",icon:"fa-circle-exclamation"},return:{className:"message-return",icon:"fa-share-from-square"},input:{className:"message-input",icon:"fa-keyboard"}};function initOutput(r){const e=document.getElementById("output");if(!e)return console.warn("No output container was found (#output)"),{success:!1,outputCont:null,sendMessage:()=>{}};r&&(messagesToAppend=[],e.innerHTML="",savedData=new Map,lastInput=null);function a(i){const{kind:t,data:o}=i,l=document.createElement("div");if(l.classList.add("message",MessageKinds[t].className),t==="embed"){const{author:d,color:c,url:g,title:f,description:h,fields:R,imageUrl:u,thumbUrl:E,footer:b}=o;if(c&&(isNaN(c)?Array.isArray(c)?l.style.borderLeftColor=`rgb(${c[0]}, ${c[1]}, ${c[2]})`:c==="Random"?l.style.borderLeftColor=`rgb(${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)})`:typeof c=="string"&&c.startsWith("#")&&c.length>=3&&(l.style.borderLeftColor=c):l.style.borderLeftColor=`#${c.toString(16)}`),!d&&!f&&!h){if(E){const s=document.createElement("img");s.style.width>s.style.height?s.style.width="96px":s.style.height="96px",s.style.margin="0 0 0.25rem auto",s.src=E,s.alt="Miniatura",s.loading="lazy",s.decoding="async",s.fetchPriority="low",l.appendChild(s)}}else{const s=document.createElement("div");s.classList.add("message-embed-hgroup");const p=document.createElement("div");if(d){const n=document.createElement(d.url?"a":"div");if(n.classList.add("message-embed-author"),d.iconUrl){const m=document.createElement("img");m.src=d.iconUrl,m.alt="\xCDcono de autor",m.loading="lazy",m.decoding="async",m.fetchPriority="low",n.appendChild(m);const y=document.createElement("span");y.textContent=d.name,n.appendChild(y)}else n.textContent=d.name;d.url&&(n.href=d.url),p.appendChild(n)}if(f){const n=document.createElement(g?"a":"h2");n.classList.add("message-embed-title"),n.textContent=f,g&&(n.href=g),p.appendChild(n)}if(h){const n=document.createElement("p");n.innerHTML=markup(h),p.appendChild(n)}if(s.appendChild(p),E){const n=document.createElement("img");n.style.width>n.style.height?n.style.width="96px":n.style.height="96px",n.style.margin="0 0 0.25rem 0.25rem",n.src=E,n.alt="Miniatura",n.loading="lazy",n.decoding="async",n.fetchPriority="low",s.appendChild(n)}l.appendChild(s)}if(R){const s=document.createElement("table"),p=[];let n={names:[],values:[]};p.push(n.names,n.values);for(const m of R)!m.inline&&n.names.length!==0&&(n={names:[],values:[]},p.push(n.names,n.values)),n.names.push(m.name),n.values.push(m.value),(!m.inline||n.names.length===3)&&(n={names:[],values:[]},p.push(n.names,n.values));for(let m=0;m<p.length;m++){const y=document.createElement("tr");for(const k of p[m]){const v=document.createElement(m%2===0?"th":"td");v.innerHTML=markup(k),y.appendChild(v)}s.appendChild(y)}l.appendChild(s)}if(u){const s=document.createElement("img");s.src=u,s.alt="Imagen",s.loading="lazy",s.decoding="async",s.fetchPriority="low",l.appendChild(s)}if(b){const s=document.createElement("div");s.classList.add("message-embed-footer");const p=document.createElement("div");if(b.iconUrl){const n=document.createElement("img");n.src=b.iconUrl,n.loading="lazy",n.decoding="async",n.fetchPriority="low",n.alt="\xCDcono de pie",s.appendChild(n)}p.textContent=b.text,s.appendChild(p),l.appendChild(s)}}else{const d=document.createElement("i");d.classList.add("message-icon","fa",MessageKinds[t].icon),l.appendChild(d);const c=document.createElement(t==="input"?"textarea":"div");if(c.style.overflowX="hidden",t==="error"){const g=document.createElement("h2");g.textContent=o.name??"Error";const f=document.createElement("p");f.classList.add("message-content"),f.innerHTML=o.message?markup(o.message.replace(/\t/g," ")):"Error desconocido",c.appendChild(g),c.appendChild(f)}else o&&(c.classList.add("message-text"),t==="input"?(c.innerHTML=lastInput==null?sanitizeHtml(o):"",c.addEventListener("focus",g=>c.select(),{passive:!0})):c.innerHTML=markup(o));if(l.appendChild(c),t==="input"){c.name="entradas",c.ariaLabel="Ingresa entradas de re-ejecuci\xF3n separadas por espacios aqu\xED",lastInput=c;const g=createSendButton(t);l.appendChild(g);async function f(h,R){const u=R.value.replace(/^\s+|\s+$/,""),E=u.length?groupQuoted(u.split(/\s+/)):[],b=await executePS(E);if(R.disabled=!0,R.removeEventListener("focus",s=>c.select()),h.disabled=!0,h.classList.add("sent"),!b){const s=document.createElement("div");s.classList.add("message",MessageKinds[t].className);const p=document.createElement("i");p.classList.add("message-icon","fa",MessageKinds[t].icon),s.appendChild(p);const n=document.createElement("textarea");n.name="entradas",n.innerHTML="",n.ariaLabel="Ingresa entradas de re-ejecuci\xF3n separadas por espacios aqu\xED",n.classList.add("message-text"),lastInput=n,s.appendChild(n);const m=createSendButton(t);s.appendChild(m),messagesToAppend.push(()=>{e.appendChild(s),messagesToAppend.length===0&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),t==="input"&&setTimeout(y=>n!=null&&!n.disabled&&n.focus(),320+80*A)}),busyOutput=!0,m.addEventListener("click",y=>f(m,n),{once:!0,passive:!0}),n.addEventListener("keydown",function(y){return y.key!=="Enter"||y.shiftKey?!0:(f(m,n),!1)},{passive:!0})}}g.addEventListener("click",h=>f(g,c),{once:!0,passive:!0}),c.addEventListener("keydown",function(h){return h.key!=="Enter"||h.shiftKey?!0:(f(g,c),!1)},{passive:!0})}}const A=messagesToAppend.length;messagesToAppend.push(()=>{e.appendChild(l),messagesToAppend.length===0&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),t==="input"&&setTimeout(d=>lastInput!=null&&!lastInput.disabled&&lastInput.focus(),320+80*A)}),busyOutput=!0}return{success:!0,outputCont:e,sendMessage:a}}function stringifyValue(r){return r.kind==="Nada"?"Nada":coerceValue(interpreter,r,"Text").value}async function executePS(r=void 0){const e=editor.getDoc().getValue().trim(),a=r==null,{success:i,sendMessage:t}=initOutput(a);if(!i)return console.error("Output container was not properly initialized"),!1;try{const l=lexer.tokenize(e),A=parser.parse(l),d=new Scope(interpreter),c=new BrowserEnvironmentProvider;declareNatives(d),await declareContext(d,c,savedData);const g=interpreter.evaluateProgram(A,d,e,c,r,a);if(!g.sendStack.length){const u=new Error("No se envi\xF3 ning\xFAn mensaje");throw u.name="TuberSendError",u}if(!g.sendStack.length){const u=new Error("Demasiados embeds");throw u.name="TuberSendError",u}const f=[],h=[];for(const u of g.sendStack)u.kind==="Embed"?h.push(u.value):f.push(stringifyValue(u));const R=f.join(`
`).trim("");if(!R.length&&!h.length){const u=new Error("No se envi\xF3 ning\xFAn mensaje");throw u.name="TuberSendError",u}for(const[u,E]of g.saveTable)if(E.kind==="Nada")savedData.delete(u);else{let b=function(s){const p={kind:s.kind};if(s.value!=null&&(p.value=s.value),s.elements!=null&&(p.elements=s.elements.map(n=>b(n))),s.entries!=null){p.entries={};for(const[n,m]of s.entries)p.entries[n]=b(m)}return p};var o=b;savedData.set(u,b(E))}f&&t({kind:"text",data:R});for(const u of h){const{author:E,title:b,description:s,fields:p,imageUrl:n,thumbUrl:m,footer:y}=u.data;if(E||b||s||p?.length||n||m||y)t({kind:"embed",data:u.data});else{const k=new Error("Se envi\xF3 un Marco vac\xEDo que fallar\xE1 en Discord");k.name="TuberSendError",t({kind:"error",data:k})}}return t({kind:"return",data:stringifyValue(g.returned)}),t({kind:"input",data:g.inputStack.map((u,E)=>u.spread?`${u.name}_0 ${u.name}_1 ... ${u.name}_N`:u.name).join(" ")}),!0}catch(l){return console.error(l),t({kind:"error",data:{name:typeof l=="string"?l:l.name,message:l.message??"Este error no ofrece informaci\xF3n adicional"}}),!1}}function toggleKeybindsWindow(r=null){const e=document.getElementById("modal-backdrop");r==null?e.classList.toggle("hidden"):r?e.classList.contains("hidden")&&e.classList.remove("hidden"):!e.classList.contains("hidden")&&e.classList.add("hidden"),e.classList.contains("hidden")||document.querySelector("#modal-content .keybinds-table").focus()}document.body.addEventListener("keydown",function(r){if(r.key==="F1")return window.onhelp=function(){return alert(),!1},r.stopPropagation(),r.preventDefault(),gotoPSDocs(),!1;if(!r.ctrlKey)return!0;switch(r.key){case"/":return toggleKeybindsWindow(),!1;case"Enter":return executePS(),!1;case"E":case"e":return r.shiftKey?(exportPS(),!1):!0;case"H":case"h":return r.shiftKey?(gotoPSDocs(),!1):!0;case"ArrowLeft":case"Left":return r.altKey?(editor.focus(),!1):!0;case"ArrowRight":case"Right":return r.altKey?((document.querySelector(".message.message-input textarea:enabled")??document.getElementById("output"))?.focus(),!1):!0}return!0},{passive:!0}),document.getElementById("modal-backdrop").addEventListener("keydown",r=>r.key!=="Enter"&&r.key!=="Escape"?!0:(toggleKeybindsWindow(!1),!1)),setTimeout(executePS,200);
